{% extends 'base.html' %}
{% block content %}
<div class="d-flex justify-content-between align-items-center">
  <h2 class="mb-0">Nagrywanie mikrofonu – {{ lesson.title }}</h2>
  <a class="btn btn-outline-secondary" href="{{ url_for('main.view_lesson', lesson_id=lesson.id) }}">Wróć do lekcji</a>
  </div>
<p class="text-muted">Nagraj fragment lekcji i wyślij do transkrypcji. Pliki są zapisywane w katalogu lekcji.</p>

<div class="d-flex gap-2 mb-3">
  <button id="startBtn" class="btn btn-primary">Start</button>
  <button id="stopBtn" class="btn btn-secondary" disabled>Stop</button>
</div>

<audio id="player" controls class="w-100" style="display:none"></audio>

<div class="mt-4">
  <h5>Transkrypcja na żywo</h5>
  <pre id="liveText" style="white-space: pre-wrap;"></pre>
  <div id="lessonCtx" data-lesson-id="{{ lesson.id }}"></div>
  <div class="text-muted small">Fragmenty audio są zapisywane w katalogu lekcji (live_...).</div>
</div>

<div class="mt-3 text-muted small">
  Streaming w czasie rzeczywistym jest aktywny podczas nagrywania. Pełny zapis pojawi się powyżej po zatrzymaniu.
  (Segment: 3 s, overlap: 0.5 s)
  
</div>

<script src="{{ url_for('static', filename='js/record_overlap.js') }}"></script>
{% endblock %}
